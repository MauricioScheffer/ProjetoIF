name: NotificaÃ§Ãµes no Discord

on:
  pull_request:
    types: [opened, closed]
  push:
    branches: [main, develop, feature/*, task/*]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Notificar Pull Request aberto
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'opened' }}
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{"content":"ðŸ“¢ Novo Pull Request no **backend** aberto por **${{ github.actor }}**: [${{ github.event.pull_request.title }}](${{ github.event.pull_request.html_url }})"}' \
          ${{ secrets.DISCORD_WEBHOOK }}

      - name: Notificar Pull Request mergeado
        if: ${{ github.event_name == 'pull_request' && github.event.action == 'closed' && github.event.pull_request.merged == true }}
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d '{"content":"âœ… Pull Request **mergeado** no **backend** por **${{ github.actor }}**: [${{ github.event.pull_request.title }}](${{ github.event.pull_request.html_url }})"}' \
          ${{ secrets.DISCORD_WEBHOOK }}

      - name: Notificar Push (commit ou merge direto)
        if: ${{ github.event_name == 'push' }}
        run: |
          curl -H "Content-Type: application/json" \
          -X POST \
          -d "{\"content\":\"ðŸš€ Novo **push** no **backend** por **${{ github.actor }}** na branch **${{ github.ref_name }}**: [Ver commit](${{ github.event.compare }})\"}" \
          ${{ secrets.DISCORD_WEBHOOK }}
